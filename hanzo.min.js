(function(e){function t(e,n){if({}.hasOwnProperty.call(t.cache,e))return t.cache[e];if("function"==typeof n)return void t.load(e,n);var r=t.resolve(e);if(!r)throw new Error("Failed to resolve module "+e);var o={id:e,rqzt:t,filename:e,exports:{},loaded:!1,parent:null,children:[]},u=e.slice(0,e.lastIndexOf("/")+1);return t.cache[e]=o.exports,r.call(o.exports,o,o.exports,u,e),o.loaded=!0,t.cache[e]=o.exports}t.modules={},t.cache={},t.resolve=function(e){return{}.hasOwnProperty.call(t.modules,e)?t.modules[e]:void 0},t.define=function(e,n){t.modules[e]=n},t.define("./api",function(e,n,r,o,u){var i,s,c,a,l,f;l=t("./utils"),s=l.isFunction,c=l.isString,a=l.newError,f=l.statusOk,e.exports=i=function(){function e(t){var n,r,o,u,i,s,c;if(null==t&&(t={}),!(this instanceof e))return new e(t);u=t.endpoint,o=t.debug,s=t.key,r=t.client,n=t.blueprints,this.debug=o,null==n&&(n=this.constructor.BLUEPRINTS),r?this.client=r:this.client=new this.constructor.CLIENT({debug:o,endpoint:u,key:s});for(i in n)c=n[i],this.addBlueprints(i,c)}return e.BLUEPRINTS={},e.CLIENT=null,e.prototype.addBlueprints=function(e,t){var n,r,o;null==this[e]&&(this[e]={}),r=function(t){return function(n,r){var o;return s(r)?t[e][n]=function(){return r.apply(t,arguments)}:(null==r.expects&&(r.expects=f),null==r.method&&(r.method="POST"),o=function(e,n){var o;return o=void 0,r.useCustomerToken&&(o=t.client.getCustomerToken()),t.client.request(r,e,o).then(function(n){var o,u;if(null!=(null!=(o=n.data)?o.error:void 0))throw a(e,n);if(!r.expects(n))throw a(e,n);return null!=r.process&&r.process.call(t,n),null!=(u=n.data)?u:n.body}).callback(n)},t[e][n]=o)}}(this);for(o in t)n=t[o],r(o,n)},e.prototype.setKey=function(e){return this.client.setKey(e)},e.prototype.setCustomerToken=function(e){return this.client.setCustomerToken(e)},e.prototype.deleteCustomerToken=function(){return this.client.deleteCustomerToken()},e.prototype.setStore=function(e){return this.storeId=e,this.client.setStore(e)},e}()}),t.define("./utils",function(e,t,n,r,o){var u;t.isFunction=function(e){return"function"==typeof e},t.isString=function(e){return"string"==typeof e},t.statusOk=function(e){return 200===e.status},t.statusCreated=function(e){return 201===e.status},t.statusNoContent=function(e){return 204===e.status},t.newError=function(e,t,n){var r,o,u,i,s,c;return null==t&&(t={}),r=null!=(o=null!=t&&null!=(u=t.data)&&null!=(i=u.error)?i.message:void 0)?o:"Request failed",null==n&&(n=new Error(r),n.message=r),n.req=e,n.data=t.data,n.responseText=t.data,n.status=t.status,n.type=null!=(s=t.data)&&null!=(c=s.error)?c.type:void 0,n},u=function(e,t,n){var r,o,u;return o=new RegExp("([?&])"+t+"=.*?(&|#|$)(.*)","gi"),o.test(e)?null!=n?e.replace(o,"$1"+t+"="+n+"$2$3"):(r=e.split("#"),e=r[0].replace(o,"$1$3").replace(/(&|\?)$/,""),null!=r[1]&&(e+="#"+r[1]),e):null!=n?(u=e.indexOf("?")!==-1?"&":"?",r=e.split("#"),e=r[0]+u+t+"="+n,null!=r[1]&&(e+="#"+r[1]),e):e},t.updateQuery=function(e,t){var n,r;if("object"!=typeof t)return e;for(n in t)r=t[n],e=u(e,n,r);return e}}),t.define("./client/xhr",function(e,n,r,o,u){var i,s,c,a,l,f,p;i=t("xhr-promise-es6/lib"),i.Promise=t("broken/dist/broken"),c=t("js-cookie/src/js.cookie"),f=t("./utils"),a=f.isFunction,l=f.newError,p=f.updateQuery,e.exports=s=function(){function e(t){return null==t&&(t={}),this instanceof e?(this.key=t.key,this.debug=t.debug,t.endpoint&&this.setEndpoint(t.endpoint),void this.getCustomerToken()):new e(t)}return e.prototype.debug=!1,e.prototype.endpoint="https://api.hanzo.io",e.prototype.sessionName="hnzo",e.prototype.setEndpoint=function(e){return this.endpoint=e.replace(/\/$/,"")},e.prototype.setStore=function(e){return this.storeId=e},e.prototype.setKey=function(e){return this.key=e},e.prototype.getKey=function(){return this.key||this.constructor.KEY},e.prototype.getCustomerToken=function(){var e;return null!=(e=c.getJSON(this.sessionName))&&null!=e.customerToken&&(this.customerToken=e.customerToken),this.customerToken},e.prototype.setCustomerToken=function(e){return c.set(this.sessionName,{customerToken:e},{expires:6048e5}),this.customerToken=e},e.prototype.deleteCustomerToken=function(){return c.set(this.sessionName,{customerToken:null},{expires:6048e5}),this.customerToken=null},e.prototype.getUrl=function(e,t,n){return a(e)&&(e=e.call(this,t)),p(this.endpoint+e,{token:n})},e.prototype.request=function(e,t,n){var r;return null==t&&(t={}),null==n&&(n=this.getKey()),r={url:this.getUrl(e.url,t,n),method:e.method},"GET"!==e.method&&(r.headers={"Content-Type":"application/json"}),"GET"===e.method?r.url=p(r.url,t):r.data=JSON.stringify(t),this.debug,(new i).send(r).then(function(e){return this.debug,e.data=e.responseText,e}).catch(function(e){var n,r;try{e.data=null!=(r=e.responseText)?r:JSON.parse(e.xhr.responseText)}catch(e){n=e}throw n=l(t,e),this.debug,n})},e}()}),t.define("xhr-promise-es6/lib",function(n,r,o,u,i){var s,c,a;s=t("parse-headers/parse-headers"),a=t("object-assign"),n.exports=c=function(){function t(){}return t.DEFAULT_CONTENT_TYPE="application/x-www-form-urlencoded; charset=UTF-8",t.Promise=e.Promise,t.prototype.send=function(e){var t;return null==e&&(e={}),t={method:"GET",data:null,headers:{},async:!0,username:null,password:null},e=a({},t,e),new this.constructor.Promise(function(t){return function(n,r){var o,u,i,s,c;if(!XMLHttpRequest)return void t._handleError("browser",r,null,"browser doesn't support XMLHttpRequest");if("string"!=typeof e.url||0===e.url.length)return void t._handleError("url",r,null,"URL is a required parameter");t._xhr=c=new XMLHttpRequest,c.onload=function(){var e;t._detachWindowUnload();try{e=t._getResponseText()}catch(e){return void t._handleError("parse",r,null,"invalid JSON response")}return n({url:t._getResponseUrl(),status:c.status,statusText:c.statusText,responseText:e,headers:t._getHeaders(),xhr:c})},c.onerror=function(){return t._handleError("error",r)},c.ontimeout=function(){return t._handleError("timeout",r)},c.onabort=function(){return t._handleError("abort",r)},t._attachWindowUnload(),c.open(e.method,e.url,e.async,e.username,e.password),null==e.data||e.headers["Content-Type"]||(e.headers["Content-Type"]=t.constructor.DEFAULT_CONTENT_TYPE),i=e.headers;for(u in i)s=i[u],c.setRequestHeader(u,s);try{return c.send(e.data)}catch(e){return o=e,t._handleError("send",r,null,o.toString())}}}(this))},t.prototype.getXHR=function(){return this._xhr},t.prototype._attachWindowUnload=function(){if(this._unloadHandler=this._handleWindowUnload.bind(this),window.attachEvent)return window.attachEvent("onunload",this._unloadHandler)},t.prototype._detachWindowUnload=function(){if(window.detachEvent)return window.detachEvent("onunload",this._unloadHandler)},t.prototype._getHeaders=function(){return s(this._xhr.getAllResponseHeaders())},t.prototype._getResponseText=function(){var e;switch(e="string"==typeof this._xhr.responseText?this._xhr.responseText:"",this._xhr.getResponseHeader("Content-Type")){case"application/json":case"text/javascript":e=JSON.parse(e+"")}return e},t.prototype._getResponseUrl=function(){return null!=this._xhr.responseURL?this._xhr.responseURL:/^X-Request-URL:/m.test(this._xhr.getAllResponseHeaders())?this._xhr.getResponseHeader("X-Request-URL"):""},t.prototype._handleError=function(e,t,n,r){return this._detachWindowUnload(),t({reason:e,status:n||this._xhr.status,statusText:r||this._xhr.statusText,xhr:this._xhr})},t.prototype._handleWindowUnload=function(){return this._xhr.abort()},t}()}),t.define("parse-headers/parse-headers",function(e,n,r,o,u){var i=t("trim"),s=t("for-each"),c=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return s(i(e).split("\n"),function(e){var n=e.indexOf(":"),r=i(e.slice(0,n)).toLowerCase(),o=i(e.slice(n+1));"undefined"==typeof t[r]?t[r]=o:c(t[r])?t[r].push(o):t[r]=[t[r],o]}),t}}),t.define("trim",function(e,t,n,r,o){function u(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=u,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}}),t.define("for-each",function(e,n,r,o,u){function i(e,t,n){if(!l(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===f.call(e)?s(e,t,n):"string"==typeof e?c(e,t,n):a(e,t,n)}function s(e,t,n){for(var r=0,o=e.length;r<o;r++)p.call(e,r)&&t.call(n,e[r],r,e)}function c(e,t,n){for(var r=0,o=e.length;r<o;r++)t.call(n,e.charAt(r),r,e)}function a(e,t,n){for(var r in e)p.call(e,r)&&t.call(n,e[r],r,e)}var l=t("is-function");e.exports=i;var f=Object.prototype.toString,p=Object.prototype.hasOwnProperty}),t.define("is-function",function(e,t,n,r,o){function u(e){var t=i.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=u;var i=Object.prototype.toString}),t.define("object-assign",function(e,t,n,r,o){"use strict";function u(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(e,t){for(var n,r,o=u(e),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var a in n)i.call(n,a)&&(o[a]=n[a]);if(Object.getOwnPropertySymbols){r=Object.getOwnPropertySymbols(n);for(var l=0;l<r.length;l++)s.call(n,r[l])&&(o[r[l]]=n[r[l]])}}return o}}),t.define("broken/dist/broken",function(t,n,r,o,u){"use strict";var i,s,c,a,l,f,p,d,h,v,y=i=function(){function e(e){this.state=e.state,this.value=e.value,this.reason=e.reason}return e.prototype.isFulfilled=function(){return"fulfilled"===this.state},e.prototype.isRejected=function(){return"rejected"===this.state},e}();f=void 0,p="undefined",a=f,c="fulfilled",l="rejected",v=function(){var t,n,r,o,u;return o=[],u=0,t=1024,n=function(){for(var n;o.length-u;){try{o[u]()}catch(t){n=t,e.console&&e.console.error(n)}o[u++]=f,u===t&&(o.splice(0,t),u=0)}},r=function(){var e,t;return typeof MutationObserver!==p?(e=document.createElement("div"),t=new MutationObserver(n),t.observe(e,{attributes:!0}),function(){e.setAttribute("a",0)}):typeof setImmediate!==p?function(){setImmediate(n)}:function(){setTimeout(n,0)}}(),function(e){o.push(e),o.length-u===1&&r()}}(),s=function(e){e&&e(function(e){return function(t){return e.resolve(t)}}(this),function(e){return function(t){return e.reject(t)}}(this))},h=function(e,t){var n,r;if("function"==typeof e.y)try{r=e.y.call(f,t),e.p.resolve(r)}catch(t){n=t,e.p.reject(n)}else e.p.resolve(t)},d=function(e,t){var n,r;if("function"==typeof e.n)try{r=e.n.call(f,t),e.p.resolve(r)}catch(t){n=t,e.p.reject(n)}else e.p.reject(t)},s.prototype.resolve=function(e){var t,n,r,o;if(this.state===a){if(e===this)return this.reject(new TypeError("Attempt to resolve promise with self"));if(r=this,e&&("function"==typeof e||"object"==typeof e))try{if(n=!0,o=e.then,"function"==typeof o)return void o.call(e,function(e){n&&(n=!1,r.resolve(e))},function(e){n&&(n=!1,r.reject(e))})}catch(e){return t=e,void(n&&this.reject(t))}this.state=c,this.v=e,r.c&&v(function(){var t,n;for(n=0,t=r.c.length;n<t;)h(r.c[n],e),n++})}},s.prototype.reject=function(t){var n;this.state===a&&(this.state=l,this.v=t,n=this.c,n?v(function(){var e,r;for(r=0,e=n.length;r<e;)d(n[r],t),r++}):!s.suppressUncaughtRejectionError&&e.console&&e.console.log("Broken Promise! Please catch rejections: ",t,t?t.stack:null))},s.prototype.then=function(e,t){var n,r,o,u;return o=new s,r={y:e,n:t,p:o},this.state===a?this.c?this.c.push(r):this.c=[r]:(u=this.state,n=this.v,v(function(){u===c?h(r,n):d(r,n)})),o},s.prototype.catch=function(e){return this.then(null,e)},s.prototype.finally=function(e){return this.then(e,e)},s.prototype.timeout=function(e,t){var n;return t=t||"Timeout",n=this,new s(function(r,o){setTimeout(function(){o(Error(t))},e),n.then(function(e){r(e)},function(e){o(e)})})},s.prototype.callback=function(e){return"function"==typeof e&&(this.then(function(t){return e(null,t)}),this.catch(function(t){return e(t,null)})),this},s.resolve=function(e){var t;return t=new s,t.resolve(e),t},s.reject=function(e){var t;return t=new s,t.reject(e),t},s.all=function(e){var t,n,r,o,u,i,c,a;for(c=[],u=0,a=new s,i=function(t,n){t&&"function"==typeof t.then||(t=s.resolve(t)),t.then(function(t){c[n]=t,u++,u===e.length&&a.resolve(c)},function(e){a.reject(e)})},t=n=0,r=e.length;n<r;t=++n)o=e[t],i(o,t);return e.length||a.resolve(c),a},s.reflect=function(e){return new s(function(t,n){return e.then(function(e){return t(new y({state:"fulfilled",value:e}))}).catch(function(e){return t(new y({state:"rejected",reason:e}))})})},s.settle=function(e){return s.all(e.map(s.reflect))};var m=s;t.exports=m}),t.define("js-cookie/src/js.cookie",function(e,t,n,r,o){!function(n){if("function"==typeof define&&define.amd)define(n);else if("object"==typeof t)e.exports=n();else{var r=window.Cookies,o=window.Cookies=n();o.noConflict=function(){return window.Cookies=r,o}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,o,u){var i;if(arguments.length>1){if(u=e({path:"/"},r.defaults,u),"number"==typeof u.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*u.expires),u.expires=s}try{i=JSON.stringify(o),/^[\{\[]/.test(i)&&(o=i)}catch(e){}return o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",o,u.expires&&"; expires="+u.expires.toUTCString(),u.path&&"; path="+u.path,u.domain&&"; domain="+u.domain,u.secure?"; secure":""].join("")}t||(i={});for(var c=document.cookie?document.cookie.split("; "):[],a=/(%[0-9A-Z]{2})+/g,l=0;l<c.length;l++){var f=c[l].split("="),p=f[0].replace(a,decodeURIComponent),d=f.slice(1).join("=");'"'===d.charAt(0)&&(d=d.slice(1,-1));try{if(d=n.read?n.read(d,p):n(d,p)||d.replace(a,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(e){}if(t===p){i=d;break}t||(i[p]=d)}catch(e){}}return i}return r.get=r.set=r,r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})})}),t.define("./blueprints/browser",function(e,n,r,o,u){var i,s,c,a,l,f,p,d,h,v,y,m,g,w,x;for(v=t("./utils"),f=v.isFunction,m=v.statusCreated,g=v.statusNoContent,w=v.statusOk,y=t("./blueprints/url"),s=y.byId,x=y.storePrefixed,c=function(e){var t;return t="/"+e,{list:{url:t,method:"GET"},get:{url:s(e),method:"GET"}}},i={account:{get:{url:"/account",method:"GET",useCustomerToken:!0},update:{url:"/account",method:"PATCH",useCustomerToken:!0},exists:{url:function(e){var t,n,r;return"/account/exists/"+(null!=(t=null!=(n=null!=(r=e.email)?r:e.username)?n:e.id)?t:e)},method:"GET",process:function(e){return e.data.exists}},create:{url:"/account/create",expects:m},enable:{url:function(e){var t;return"/account/enable/"+(null!=(t=e.tokenId)?t:e)}},login:{url:"/account/login",process:function(e){return this.setCustomerToken(e.data.token),e}},logout:function(){return this.deleteCustomerToken()},reset:{url:"/account/reset",useCustomerToken:!0},updateOrder:{url:function(e){var t,n;return"/account/order/"+(null!=(t=null!=(n=e.orderId)?n:e.id)?t:e)},method:"PATCH",useCustomerToken:!0},confirm:{url:function(e){var t;return"/account/confirm/"+(null!=(t=e.tokenId)?t:e)},useCustomerToken:!0}},cart:{create:{url:"/cart",expects:m},update:{url:function(e){var t;return"/cart/"+(null!=(t=e.id)?t:e)},method:"PATCH"},discard:{url:function(e){var t;return"/cart/"+(null!=(t=e.id)?t:e)+"/discard"}},set:{url:function(e){var t;return"/cart/"+(null!=(t=e.id)?t:e)+"/set"}}},review:{create:{url:"/review",expects:m},get:{url:function(e){var t;return"/review/"+(null!=(t=e.id)?t:e)},method:"GET"}},checkout:{authorize:{url:x("/checkout/authorize")},capture:{url:x(function(e){var t;return"/checkout/capture/"+(null!=(t=e.orderId)?t:e)})},charge:{url:x("/checkout/charge")},paypal:{url:x("/checkout/paypal")}},referrer:{create:{url:"/referrer",expects:m},get:{url:function(e){var t;return"/referrer/"+(null!=(t=e.id)?t:e)},method:"GET"}}},h=["collection","coupon","product","variant"],a=function(e){return i[e]=c(e)},l=0,p=h.length;l<p;l++)d=h[l],a(d);e.exports=i}),t.define("./blueprints/url",function(e,n,r,o,u){var i,s;i=t("./utils").isFunction,n.storePrefixed=s=function(e){return function(t){var n;return n=i(e)?e(t):e,null!=this.storeId?"/store/"+this.storeId+n:n}},n.byId=function(e){switch(e){case"coupon":return s(function(e){var t;return"/coupon/"+(null!=(t=e.code)?t:e)});case"collection":return s(function(e){var t;return"/collection/"+(null!=(t=e.slug)?t:e)});case"product":return s(function(e){var t,n;return"/product/"+(null!=(t=null!=(n=e.id)?n:e.slug)?t:e)});case"variant":return s(function(e){var t,n;return"/variant/"+(null!=(t=null!=(n=e.id)?n:e.sku)?t:e)});case"site":return function(e){var t,n;return"/site/"+(null!=(t=null!=(n=e.id)?n:e.name)?t:e)};default:return function(t){var n;return"/"+e+"/"+(null!=(n=t.id)?n:t)}}}}),t.define("./browser",function(n,r,o,u,i){var s,c;null==e.Hanzo&&(e.Hanzo={}),s=t("./api"),c=t("./client/xhr"),s.CLIENT=c,s.BLUEPRINTS=t("./blueprints/browser"),Hanzo.Api=s,Hanzo.Client=c,n.exports=Hanzo}),t("./browser")}).call(this,this);
