(function(e){function t(e,r){if("function"==typeof r)return t.load(e,r);if({}.hasOwnProperty.call(t.cache,e))return t.cache[e];var o=t.resolve(e);if(!o)throw new Error("Failed to resolve module "+e);var i={id:e,require:t,filename:e,exports:{},loaded:!1,parent:null,children:[]},u=e.slice(0,e.lastIndexOf("/")+1);return t.cache[e]=i.exports,o.call(i.exports,i,i.exports,u,e,n),i.loaded=!0,t.cache[e]=i.exports}var n={title:"browser",browser:!0,env:{},argv:[],nextTick:function(e){setTimeout(e,0)},cwd:function(){return"/"},chdir:function(){}};t.modules={},t.cache={},t.resolve=function(e){return{}.hasOwnProperty.call(t.modules,e)?t.modules[e]:void 0},t.define=function(e,n){t.modules[e]=n},t.define("./api",function(e,n,r,o,i){var u,s,c,a,l,f;l=t("./utils"),s=l.isFunction,c=l.isString,a=l.newError,f=l.statusOk,e.exports=u=function(){function e(t){var n,r,o,i,u,s,c;if(null==t&&(t={}),!(this instanceof e))return new e(t);i=t.endpoint,o=t.debug,s=t.key,r=t.client,n=t.blueprints,this.debug=o,null==n&&(n=this.constructor.BLUEPRINTS),r?this.client=r:this.client=new this.constructor.CLIENT({debug:o,endpoint:i,key:s});for(u in n)c=n[u],this.addBlueprints(u,c)}return e.BLUEPRINTS={},e.CLIENT=null,e.prototype.addBlueprints=function(e,t){var n,r,o;null==this[e]&&(this[e]={}),r=function(t){return function(n,r){var o;return s(r)?t[e][n]=function(){return r.apply(t,arguments)}:(null==r.expects&&(r.expects=f),null==r.method&&(r.method="POST"),o=function(e,n){var o;return o=void 0,r.useCustomerToken&&(o=t.client.getCustomerToken()),t.client.request(r,e,o).then(function(n){var o,i;if(null!=(null!=(o=n.data)?o.error:void 0))throw a(e,n);if(!r.expects(n))throw a(e,n);return null!=r.process&&r.process.call(t,n),null!=(i=n.data)?i:n.body}).callback(n)},t[e][n]=o)}}(this);for(o in t)n=t[o],r(o,n)},e.prototype.setKey=function(e){return this.client.setKey(e)},e.prototype.setCustomerToken=function(e){return this.client.setCustomerToken(e)},e.prototype.deleteCustomerToken=function(){return this.client.deleteCustomerToken()},e.prototype.setStore=function(e){return this.storeId=e,this.client.setStore(e)},e}()}),t.define("./utils",function(e,t,n,r,o){var i;t.isFunction=function(e){return"function"==typeof e},t.isString=function(e){return"string"==typeof e},t.statusOk=function(e){return 200===e.status},t.statusCreated=function(e){return 201===e.status},t.statusNoContent=function(e){return 204===e.status},t.newError=function(e,t,n){var r,o,i,u,s,c;return null==t&&(t={}),r=null!=(o=null!=t&&null!=(i=t.data)&&null!=(u=i.error)?u.message:void 0)?o:"Request failed",null==n&&(n=new Error(r),n.message=r),n.req=e,n.data=t.data,n.responseText=t.data,n.status=t.status,n.type=null!=(s=t.data)&&null!=(c=s.error)?c.type:void 0,n},i=function(e,t,n){var r,o,i;return o=new RegExp("([?&])"+t+"=.*?(&|#|$)(.*)","gi"),o.test(e)?null!=n?e.replace(o,"$1"+t+"="+n+"$2$3"):(r=e.split("#"),e=r[0].replace(o,"$1$3").replace(/(&|\?)$/,""),null!=r[1]&&(e+="#"+r[1]),e):null!=n?(i=-1!==e.indexOf("?")?"&":"?",r=e.split("#"),e=r[0]+i+t+"="+n,null!=r[1]&&(e+="#"+r[1]),e):e},t.updateQuery=function(e,t){var n,r;if("object"!=typeof t)return e;for(n in t)r=t[n],e=i(e,n,r);return e}}),t.define("./client/xhr",function(e,n,r,o,i){var u,s,c,a,l,f,p;u=t("xhr-promise-es6/lib"),u.Promise=t("broken/lib"),c=t("js-cookie/src/js.cookie"),f=t("./utils"),a=f.isFunction,l=f.newError,p=f.updateQuery,e.exports=s=function(){function e(t){return null==t&&(t={}),this instanceof e?(this.key=t.key,this.debug=t.debug,t.endpoint&&this.setEndpoint(t.endpoint),void this.getCustomerToken()):new e(t)}return e.prototype.debug=!1,e.prototype.endpoint="https://api.hanzo.io",e.prototype.sessionName="hnzo",e.prototype.setEndpoint=function(e){return this.endpoint=e.replace(/\/$/,"")},e.prototype.setStore=function(e){return this.storeId=e},e.prototype.setKey=function(e){return this.key=e},e.prototype.getKey=function(){return this.key||this.constructor.KEY},e.prototype.getCustomerToken=function(){var e;return null!=(e=c.getJSON(this.sessionName))&&null!=e.customerToken&&(this.customerToken=e.customerToken),this.customerToken},e.prototype.setCustomerToken=function(e){return c.set(this.sessionName,{customerToken:e},{expires:6048e5}),this.customerToken=e},e.prototype.deleteCustomerToken=function(){return c.set(this.sessionName,{customerToken:null},{expires:6048e5}),this.customerToken=null},e.prototype.getUrl=function(e,t,n){return a(e)&&(e=e.call(this,t)),p(this.endpoint+e,{token:n})},e.prototype.request=function(e,t,n){var r;return null==t&&(t={}),null==n&&(n=this.getKey()),r={url:this.getUrl(e.url,t,n),method:e.method},"GET"!==e.method&&(r.headers={"Content-Type":"application/json"}),"GET"===e.method?r.url=p(r.url,t):r.data=JSON.stringify(t),this.debug,(new u).send(r).then(function(e){return this.debug,e.data=e.responseText,e})["catch"](function(e){var n,r,o;try{e.data=null!=(o=e.responseText)?o:JSON.parse(e.xhr.responseText)}catch(r){n=r}throw n=l(t,e),this.debug,n})},e}()}),t.define("xhr-promise-es6/lib",function(n,r,o,i,u){var s,c,a;s=t("parse-headers/parse-headers"),a=t("object-assign"),n.exports=c=function(){function t(){}return t.DEFAULT_CONTENT_TYPE="application/x-www-form-urlencoded; charset=UTF-8",t.Promise=e.Promise,t.prototype.send=function(e){var t;return null==e&&(e={}),t={method:"GET",data:null,headers:{},async:!0,username:null,password:null},e=a({},t,e),new this.constructor.Promise(function(t){return function(n,r){var o,i,u,s,c;if(!XMLHttpRequest)return void t._handleError("browser",r,null,"browser doesn't support XMLHttpRequest");if("string"!=typeof e.url||0===e.url.length)return void t._handleError("url",r,null,"URL is a required parameter");t._xhr=c=new XMLHttpRequest,c.onload=function(){var e;t._detachWindowUnload();try{e=t._getResponseText()}catch(o){return void t._handleError("parse",r,null,"invalid JSON response")}return n({url:t._getResponseUrl(),status:c.status,statusText:c.statusText,responseText:e,headers:t._getHeaders(),xhr:c})},c.onerror=function(){return t._handleError("error",r)},c.ontimeout=function(){return t._handleError("timeout",r)},c.onabort=function(){return t._handleError("abort",r)},t._attachWindowUnload(),c.open(e.method,e.url,e.async,e.username,e.password),null==e.data||e.headers["Content-Type"]||(e.headers["Content-Type"]=t.constructor.DEFAULT_CONTENT_TYPE),u=e.headers;for(i in u)s=u[i],c.setRequestHeader(i,s);try{return c.send(e.data)}catch(a){return o=a,t._handleError("send",r,null,o.toString())}}}(this))},t.prototype.getXHR=function(){return this._xhr},t.prototype._attachWindowUnload=function(){return this._unloadHandler=this._handleWindowUnload.bind(this),window.attachEvent?window.attachEvent("onunload",this._unloadHandler):void 0},t.prototype._detachWindowUnload=function(){return window.detachEvent?window.detachEvent("onunload",this._unloadHandler):void 0},t.prototype._getHeaders=function(){return s(this._xhr.getAllResponseHeaders())},t.prototype._getResponseText=function(){var e;switch(e="string"==typeof this._xhr.responseText?this._xhr.responseText:"",this._xhr.getResponseHeader("Content-Type")){case"application/json":case"text/javascript":e=JSON.parse(e+"")}return e},t.prototype._getResponseUrl=function(){return null!=this._xhr.responseURL?this._xhr.responseURL:/^X-Request-URL:/m.test(this._xhr.getAllResponseHeaders())?this._xhr.getResponseHeader("X-Request-URL"):""},t.prototype._handleError=function(e,t,n,r){return this._detachWindowUnload(),t({reason:e,status:n||this._xhr.status,statusText:r||this._xhr.statusText,xhr:this._xhr})},t.prototype._handleWindowUnload=function(){return this._xhr.abort()},t}()}),t.define("parse-headers/parse-headers",function(e,n,r,o,i){var u=t("trim"),s=t("for-each"),c=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return s(u(e).split("\n"),function(e){var n=e.indexOf(":"),r=u(e.slice(0,n)).toLowerCase(),o=u(e.slice(n+1));"undefined"==typeof t[r]?t[r]=o:c(t[r])?t[r].push(o):t[r]=[t[r],o]}),t}}),t.define("trim",function(e,t,n,r,o){function i(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=i,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}}),t.define("for-each",function(e,n,r,o,i){function u(e,t,n){if(!l(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===f.call(e)?s(e,t,n):"string"==typeof e?c(e,t,n):a(e,t,n)}function s(e,t,n){for(var r=0,o=e.length;o>r;r++)p.call(e,r)&&t.call(n,e[r],r,e)}function c(e,t,n){for(var r=0,o=e.length;o>r;r++)t.call(n,e.charAt(r),r,e)}function a(e,t,n){for(var r in e)p.call(e,r)&&t.call(n,e[r],r,e)}var l=t("is-function");e.exports=u;var f=Object.prototype.toString,p=Object.prototype.hasOwnProperty}),t.define("is-function",function(e,t,n,r,o){function i(e){var t=u.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=i;var u=Object.prototype.toString}),t.define("object-assign",function(e,t,n,r,o){"use strict";function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var u=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(e,t){for(var n,r,o=i(e),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var a in n)u.call(n,a)&&(o[a]=n[a]);if(Object.getOwnPropertySymbols){r=Object.getOwnPropertySymbols(n);for(var l=0;l<r.length;l++)s.call(n,r[l])&&(o[r[l]]=n[r[l]])}}return o}}),t.define("broken/lib",function(e,n,r,o,i){var u,s;u=t("zousan/zousan-min"),u.suppressUncaughtRejectionError=!1,s=function(){function e(e){this.state=e.state,this.value=e.value,this.reason=e.reason}return e.prototype.isFulfilled=function(){return"fulfilled"===this.state},e.prototype.isRejected=function(){return"rejected"===this.state},e}(),u.reflect=function(e){return new u(function(t,n){return e.then(function(e){return t(new s({state:"fulfilled",value:e}))})["catch"](function(e){return t(new s({state:"rejected",reason:e}))})})},u.settle=function(e){return u.all(e.map(u.reflect))},u.prototype.callback=function(e){return"function"==typeof e&&(this.then(function(t){return e(null,t)}),this["catch"](function(t){return e(t,null)})),this},e.exports=u}),t.define("zousan/zousan-min",function(t,n,r,o,i){!function(e){"use strict";function n(e){if(e){var t=this;e(function(e){t.resolve(e)},function(e){t.reject(e)})}}function r(e,t){if("function"==typeof e.y)try{var n=e.y.call(u,t);e.p.resolve(n)}catch(r){e.p.reject(r)}else e.p.resolve(t)}function o(e,t){if("function"==typeof e.n)try{var n=e.n.call(u,t);e.p.resolve(n)}catch(r){e.p.reject(r)}else e.p.reject(t)}var i,u,s="fulfilled",c="rejected",a="undefined",l=function(){function e(){for(;t.length-n;)t[n](),t[n++]=u,n==r&&(t.splice(0,r),n=0)}var t=[],n=0,r=1024,o=function(){if(typeof MutationObserver!==a){var t=document.createElement("div"),n=new MutationObserver(e);return n.observe(t,{attributes:!0}),function(){t.setAttribute("a",0)}}return typeof setImmediate!==a?function(){setImmediate(e)}:function(){setTimeout(e,0)}}();return function(e){t.push(e),t.length-n==1&&o()}}();n.prototype={resolve:function(e){if(this.state===i){if(e===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var t=this;if(e&&("function"==typeof e||"object"==typeof e))try{var n=!0,o=e.then;if("function"==typeof o)return void o.call(e,function(e){n&&(n=!1,t.resolve(e))},function(e){n&&(n=!1,t.reject(e))})}catch(u){return void(n&&this.reject(u))}this.state=s,this.v=e,t.c&&l(function(){for(var n=0,o=t.c.length;o>n;n++)r(t.c[n],e)})}},reject:function(e){if(this.state===i){this.state=c,this.v=e;var t=this.c;t?l(function(){for(var n=0,r=t.length;r>n;n++)o(t[n],e)}):n.suppressUncaughtRejectionError||void 0}},then:function(e,t){var u=new n,c={y:e,n:t,p:u};if(this.state===i)this.c?this.c.push(c):this.c=[c];else{var a=this.state,f=this.v;l(function(){a===s?r(c,f):o(c,f)})}return u},"catch":function(e){return this.then(null,e)},"finally":function(e){return this.then(e,e)},timeout:function(e,t){t=t||"Timeout";var r=this;return new n(function(n,o){setTimeout(function(){o(Error(t))},e),r.then(function(e){n(e)},function(e){o(e)})})}},n.resolve=function(e){var t=new n;return t.resolve(e),t},n.reject=function(e){var t=new n;return t.reject(e),t},n.all=function(e){function t(t,u){"function"!=typeof t.then&&(t=n.resolve(t)),t.then(function(t){r[u]=t,o++,o==e.length&&i.resolve(r)},function(e){i.reject(e)})}for(var r=[],o=0,i=new n,u=0;u<e.length;u++)t(e[u],u);return e.length||i.resolve(r),i},typeof t!=a&&t.exports&&(t.exports=n),e.Zousan=n,n.soon=l}("undefined"!=typeof e?e:this)}),t.define("js-cookie/src/js.cookie",function(e,t,n,r,o){!function(n){if("function"==typeof define&&define.amd)define(n);else if("object"==typeof t)e.exports=n();else{var r=window.Cookies,o=window.Cookies=n();o.noConflict=function(){return window.Cookies=r,o}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,o,i){var u;if(arguments.length>1){if(i=e({path:"/"},r.defaults,i),"number"==typeof i.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*i.expires),i.expires=s}try{u=JSON.stringify(o),/^[\{\[]/.test(u)&&(o=u)}catch(c){}return o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",o,i.expires&&"; expires="+i.expires.toUTCString(),i.path&&"; path="+i.path,i.domain&&"; domain="+i.domain,i.secure?"; secure":""].join("")}t||(u={});for(var a=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,f=0;f<a.length;f++){var p=a[f].split("="),d=p[0].replace(l,decodeURIComponent),h=p.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{if(h=n.read?n.read(h,d):n(h,d)||h.replace(l,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(c){}if(t===d){u=h;break}t||(u[d]=h)}catch(c){}}return u}return r.get=r.set=r,r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})})}),t.define("./blueprints/browser",function(e,n,r,o,i){var u,s,c,a,l,f,p,d,h,v,y,m,g,w,x;for(v=t("./utils"),f=v.isFunction,m=v.statusCreated,g=v.statusNoContent,w=v.statusOk,y=t("./blueprints/url"),s=y.byId,x=y.storePrefixed,c=function(e){var t;return t="/"+e,{list:{url:t,method:"GET"},get:{url:s(e),method:"GET"}}},u={account:{get:{url:"/account",method:"GET",useCustomerToken:!0},update:{url:"/account",method:"PATCH",useCustomerToken:!0},exists:{url:function(e){var t,n,r;return"/account/exists/"+(null!=(t=null!=(n=null!=(r=e.email)?r:e.username)?n:e.id)?t:e)},method:"GET",process:function(e){return e.data.exists}},create:{url:"/account/create",expects:m},enable:{url:function(e){var t;return"/account/enable/"+(null!=(t=e.tokenId)?t:e)}},login:{url:"/account/login",process:function(e){return this.setCustomerToken(e.data.token),e}},logout:function(){return this.deleteCustomerToken()},reset:{url:"/account/reset",useCustomerToken:!0},updateOrder:{url:function(e){var t,n;return"/account/order/"+(null!=(t=null!=(n=e.orderId)?n:e.id)?t:e)},method:"PATCH",useCustomerToken:!0},confirm:{url:function(e){var t;return"/account/confirm/"+(null!=(t=e.tokenId)?t:e)},useCustomerToken:!0}},cart:{create:{url:"/cart",expects:m},update:{url:function(e){var t;return"/cart/"+(null!=(t=e.id)?t:e)},method:"PATCH"},discard:{url:function(e){var t;return"/cart/"+(null!=(t=e.id)?t:e)+"/discard"}},set:{url:function(e){var t;return"/cart/"+(null!=(t=e.id)?t:e)+"/set"}}},checkout:{authorize:{url:x("/checkout/authorize")},capture:{url:x(function(e){var t;return"/checkout/capture/"+(null!=(t=e.orderId)?t:e)})},charge:{url:x("/checkout/charge")},paypal:{url:x("/checkout/paypal")}},referrer:{create:{url:"/referrer",expects:m},get:{url:function(e){var t;return"/referrer/"+(null!=(t=e.id)?t:e)},method:"GET"}}},h=["collection","coupon","product","variant"],a=function(e){return u[e]=c(e)},l=0,p=h.length;p>l;l++)d=h[l],a(d);e.exports=u}),t.define("./blueprints/url",function(e,n,r,o,i){var u,s;u=t("./utils").isFunction,n.storePrefixed=s=function(e){return function(t){var n;return n=u(e)?e(t):e,null!=this.storeId?"/store/"+this.storeId+n:n}},n.byId=function(e){switch(e){case"coupon":return s(function(e){var t;return"/coupon/"+(null!=(t=e.code)?t:e)});case"collection":return s(function(e){var t;return"/collection/"+(null!=(t=e.slug)?t:e)});case"product":return s(function(e){var t,n;return"/product/"+(null!=(t=null!=(n=e.id)?n:e.slug)?t:e)});case"variant":return s(function(e){var t,n;return"/variant/"+(null!=(t=null!=(n=e.id)?n:e.sku)?t:e)});case"site":return function(e){var t,n;return"/site/"+(null!=(t=null!=(n=e.id)?n:e.name)?t:e)};default:return function(t){var n;return"/"+e+"/"+(null!=(n=t.id)?n:t)}}}}),t.define("./browser",function(n,r,o,i,u){var s,c;null==e.Hanzo&&(e.Hanzo={}),s=t("./api"),c=t("./client/xhr"),s.CLIENT=c,s.BLUEPRINTS=t("./blueprints/browser"),Hanzo.Api=s,Hanzo.Client=c,n.exports=Hanzo}),t("./browser")}).call(this,this);
