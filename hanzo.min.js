(function(t){function e(t,n){if({}.hasOwnProperty.call(e.cache,t))return e.cache[t];if("function"==typeof n)return void e.load(t,n);var r=e.resolve(t);if(!r)throw new Error("Failed to resolve module "+t);var o={id:t,rqzt:e,filename:t,exports:{},loaded:!1,parent:null,children:[]},u=t.slice(0,t.lastIndexOf("/")+1);return e.cache[t]=o.exports,r.call(o.exports,o,o.exports,u,t),o.loaded=!0,e.cache[t]=o.exports}e.modules={},e.cache={},e.resolve=function(t){return{}.hasOwnProperty.call(e.modules,t)?e.modules[t]:void 0},e.define=function(t,n){e.modules[t]=n},e.define("./api",function(t,n,r,o,u){var i,s,c,a;c=e("./utils"),i=c.isFunction,c.isString,s=c.newError,a=c.statusOk,t.exports=function(){function t(e){var n,r,o,u,i,s,c;if(null==e&&(e={}),!(this instanceof t))return new t(e);u=e.endpoint,o=e.debug,s=e.key,r=e.client,n=e.blueprints,this.debug=o,null==n&&(n=this.constructor.BLUEPRINTS),this.client=r?r:new this.constructor.CLIENT({debug:o,endpoint:u,key:s});for(i in n)c=n[i],this.addBlueprints(i,c)}return t.BLUEPRINTS={},t.CLIENT=null,t.prototype.addBlueprints=function(t,e){var n,r,o;null==this[t]&&(this[t]={}),r=function(e){return function(n,r){var o;return i(r)?e[t][n]=function(){return r.apply(e,arguments)}:(null==r.expects&&(r.expects=a),null==r.method&&(r.method="POST"),o=function(t,n){var o;return o=void 0,r.useCustomerToken&&(o=e.client.getCustomerToken()),e.client.request(r,t,o).then(function(n){var o,u;if(null!=(null!=(o=n.data)?o.error:void 0))throw s(t,n);if(!r.expects(n))throw s(t,n);return null!=r.process&&r.process.call(e,n),null!=(u=n.data)?u:n.body}).callback(n)},e[t][n]=o)}}(this);for(o in e)n=e[o],r(o,n)},t.prototype.setKey=function(t){return this.client.setKey(t)},t.prototype.setCustomerToken=function(t){return this.client.setCustomerToken(t)},t.prototype.deleteCustomerToken=function(){return this.client.deleteCustomerToken()},t.prototype.setStore=function(t){return this.storeId=t,this.client.setStore(t)},t}()}),e.define("./utils",function(t,e,n,r,o){var u;e.isFunction=function(t){return"function"==typeof t},e.isString=function(t){return"string"==typeof t},e.statusOk=function(t){return 200===t.status},e.statusCreated=function(t){return 201===t.status},e.statusNoContent=function(t){return 204===t.status},e.newError=function(t,e,n){var r,o,u,i,s,c;return null==e&&(e={}),r=null!=(o=null!=e&&null!=(u=e.data)&&null!=(i=u.error)?i.message:void 0)?o:"Request failed",null==n&&(n=new Error(r),n.message=r),n.req=t,n.data=e.data,n.responseText=e.data,n.status=e.status,n.type=null!=(s=e.data)&&null!=(c=s.error)?c.type:void 0,n},u=function(t,e,n){var r,o,u;return o=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi"),o.test(t)?null!=n?t.replace(o,"$1"+e+"="+n+"$2$3"):(r=t.split("#"),t=r[0].replace(o,"$1$3").replace(/(&|\?)$/,""),null!=r[1]&&(t+="#"+r[1]),t):null!=n?(u=t.indexOf("?")!==-1?"&":"?",r=t.split("#"),t=r[0]+u+e+"="+n,null!=r[1]&&(t+="#"+r[1]),t):t},e.updateQuery=function(t,e){var n,r;if("object"!=typeof e)return t;for(n in e)r=e[n],t=u(t,n,r);return t}}),e.define("./client/xhr",function(t,n,r,o,u){var i,s,c,a,l,f;i=e("xhr-promise-es6/lib"),i.Promise=e("broken/dist/broken"),s=e("js-cookie/src/js.cookie"),l=e("./utils"),c=l.isFunction,a=l.newError,f=l.updateQuery,t.exports=function(){function t(e){if(null==e&&(e={}),!(this instanceof t))return new t(e);this.key=e.key,this.debug=e.debug,e.endpoint&&this.setEndpoint(e.endpoint),this.getCustomerToken()}return t.prototype.debug=!1,t.prototype.endpoint="https://api.hanzo.io",t.prototype.sessionName="hnzo",t.prototype.setEndpoint=function(t){return this.endpoint=t.replace(/\/$/,"")},t.prototype.setStore=function(t){return this.storeId=t},t.prototype.setKey=function(t){return this.key=t},t.prototype.getKey=function(){return this.key||this.constructor.KEY},t.prototype.getCustomerToken=function(){var t;return null!=(t=s.getJSON(this.sessionName))&&null!=t.customerToken&&(this.customerToken=t.customerToken),this.customerToken},t.prototype.setCustomerToken=function(t){return s.set(this.sessionName,{customerToken:t},{expires:6048e5}),this.customerToken=t},t.prototype.deleteCustomerToken=function(){return s.set(this.sessionName,{customerToken:null},{expires:6048e5}),this.customerToken=null},t.prototype.getUrl=function(t,e,n){return c(t)&&(t=t.call(this,e)),f(this.endpoint+t,{token:n})},t.prototype.request=function(t,e,n){var r;return null==e&&(e={}),null==n&&(n=this.getKey()),r={url:this.getUrl(t.url,e,n),method:t.method},"GET"!==t.method&&(r.headers={"Content-Type":"application/json"}),"GET"===t.method?r.url=f(r.url,e):r.data=JSON.stringify(e),this.debug,(new i).send(r).then(function(t){return this.debug,t.data=t.responseText,t}).catch(function(t){var n,r;try{t.data=null!=(r=t.responseText)?r:JSON.parse(t.xhr.responseText)}catch(t){n=t}throw n=a(e,t),this.debug,n})},t}()}),e.define("xhr-promise-es6/lib",function(n,r,o,u,i){var s,c;s=e("parse-headers/parse-headers"),c=e("object-assign"),n.exports=function(){function e(){}return e.DEFAULT_CONTENT_TYPE="application/x-www-form-urlencoded; charset=UTF-8",e.Promise=t.Promise,e.prototype.send=function(t){var e;return null==t&&(t={}),e={method:"GET",data:null,headers:{},async:!0,username:null,password:null},t=c({},e,t),new this.constructor.Promise(function(e){return function(n,r){var o,u,i,s,c;if(!XMLHttpRequest)return void e._handleError("browser",r,null,"browser doesn't support XMLHttpRequest");if("string"!=typeof t.url||0===t.url.length)return void e._handleError("url",r,null,"URL is a required parameter");e._xhr=c=new XMLHttpRequest,c.onload=function(){var t;e._detachWindowUnload();try{t=e._getResponseText()}catch(t){return void e._handleError("parse",r,null,"invalid JSON response")}return n({url:e._getResponseUrl(),status:c.status,statusText:c.statusText,responseText:t,headers:e._getHeaders(),xhr:c})},c.onerror=function(){return e._handleError("error",r)},c.ontimeout=function(){return e._handleError("timeout",r)},c.onabort=function(){return e._handleError("abort",r)},e._attachWindowUnload(),c.open(t.method,t.url,t.async,t.username,t.password),null==t.data||t.headers["Content-Type"]||(t.headers["Content-Type"]=e.constructor.DEFAULT_CONTENT_TYPE),i=t.headers;for(u in i)s=i[u],c.setRequestHeader(u,s);try{return c.send(t.data)}catch(t){return o=t,e._handleError("send",r,null,o.toString())}}}(this))},e.prototype.getXHR=function(){return this._xhr},e.prototype._attachWindowUnload=function(){if(this._unloadHandler=this._handleWindowUnload.bind(this),window.attachEvent)return window.attachEvent("onunload",this._unloadHandler)},e.prototype._detachWindowUnload=function(){if(window.detachEvent)return window.detachEvent("onunload",this._unloadHandler)},e.prototype._getHeaders=function(){return s(this._xhr.getAllResponseHeaders())},e.prototype._getResponseText=function(){var t;switch(t="string"==typeof this._xhr.responseText?this._xhr.responseText:"",this._xhr.getResponseHeader("Content-Type")){case"application/json":case"text/javascript":t=JSON.parse(t+"")}return t},e.prototype._getResponseUrl=function(){return null!=this._xhr.responseURL?this._xhr.responseURL:/^X-Request-URL:/m.test(this._xhr.getAllResponseHeaders())?this._xhr.getResponseHeader("X-Request-URL"):""},e.prototype._handleError=function(t,e,n,r){return this._detachWindowUnload(),e({reason:t,status:n||this._xhr.status,statusText:r||this._xhr.statusText,xhr:this._xhr})},e.prototype._handleWindowUnload=function(){return this._xhr.abort()},e}()}),e.define("parse-headers/parse-headers",function(t,n,r,o,u){var i=e("trim"),s=e("for-each"),c=function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=function(t){if(!t)return{};var e={};return s(i(t).split("\n"),function(t){var n=t.indexOf(":"),r=i(t.slice(0,n)).toLowerCase(),o=i(t.slice(n+1));void 0===e[r]?e[r]=o:c(e[r])?e[r].push(o):e[r]=[e[r],o]}),e}}),e.define("trim",function(t,e,n,r,o){function u(t){return t.replace(/^\s*|\s*$/g,"")}e=t.exports=u,e.left=function(t){return t.replace(/^\s*/,"")},e.right=function(t){return t.replace(/\s*$/,"")}}),e.define("for-each",function(t,n,r,o,u){function i(t,e,n){if(!l(e))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===f.call(t)?s(t,e,n):"string"==typeof t?c(t,e,n):a(t,e,n)}function s(t,e,n){for(var r=0,o=t.length;r<o;r++)p.call(t,r)&&e.call(n,t[r],r,t)}function c(t,e,n){for(var r=0,o=t.length;r<o;r++)e.call(n,t.charAt(r),r,t)}function a(t,e,n){for(var r in t)p.call(t,r)&&e.call(n,t[r],r,t)}var l=e("is-function");t.exports=i;var f=Object.prototype.toString,p=Object.prototype.hasOwnProperty}),e.define("is-function",function(t,e,n,r,o){function u(t){var e=i.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}t.exports=u;var i=Object.prototype.toString}),e.define("object-assign",function(t,e,n,r,o){"use strict";function u(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(t,e){for(var n,r,o=u(t),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var a in n)i.call(n,a)&&(o[a]=n[a]);if(Object.getOwnPropertySymbols){r=Object.getOwnPropertySymbols(n);for(var l=0;l<r.length;l++)s.call(n,r[l])&&(o[r[l]]=n[r[l]])}}return o}}),e.define("broken/dist/broken",function(e,n,r,o,u){"use strict";var i,s,c=i=function(){function t(t){this.state=t.state,this.value=t.value,this.reason=t.reason}return t.prototype.isFulfilled=function(){return"fulfilled"===this.state},t.prototype.isRejected=function(){return"rejected"===this.state},t}(),a=void 0,l="undefined";s=function(){var e,n,r,o,u;return o=[],u=0,e=1024,n=function(){for(var n;o.length-u;){try{o[u]()}catch(e){n=e,t.console&&t.console.error(n)}o[u++]=a,u===e&&(o.splice(0,e),u=0)}},r=function(){var t,e;return typeof MutationObserver!==l?(t=document.createElement("div"),e=new MutationObserver(n),e.observe(t,{attributes:!0}),function(){t.setAttribute("a",0)}):typeof setImmediate!==l?function(){setImmediate(n)}:function(){setTimeout(n,0)}}(),function(t){o.push(t),o.length-u===1&&r()}}();var f,p,d,h,v,y,m,g=s;v=void 0,d=v,p="fulfilled",h="rejected",m=function(t,e){var n,r;if("function"==typeof t.y)try{r=t.y.call(v,e),t.p.resolve(r)}catch(e){n=e,t.p.reject(n)}else t.p.resolve(e)},y=function(t,e){var n,r;if("function"==typeof t.n)try{r=t.n.call(v,e),t.p.resolve(r)}catch(e){n=e,t.p.reject(n)}else t.p.reject(e)},f=function(){function e(t){t&&t(function(t){return function(e){return t.resolve(e)}}(this),function(t){return function(e){return t.reject(e)}}(this))}return e.prototype.resolve=function(t){var e,n,r,o;if(this.state===d){if(t===this)return this.reject(new TypeError("Attempt to resolve promise with self"));if(t&&("function"==typeof t||"object"==typeof t))try{if(r=!0,o=t.then,"function"==typeof o)return void o.call(t,function(t){return function(e){r&&(r&&(r=!1),t.resolve(e))}}(this),function(t){return function(e){r&&(r=!1,t.reject(e))}}(this))}catch(t){return n=t,void(r&&this.reject(n))}this.state=p,this.v=t,(e=this.c)&&g(function(n){return function(){var n,r,o;for(r=0,o=e.length;r<o;r++)n=e[r],m(n,t)}}(this))}},e.prototype.reject=function(n){var r;this.state===d&&(this.state=h,this.v=n,(r=this.c)?g(function(){var t,e,o;for(e=0,o=r.length;e<o;e++)t=r[e],y(t,n)}):!e.suppressUncaughtRejectionError&&t.console&&t.console.log("Broken Promise, please catch rejections: ",n,n?n.stack:null))},e.prototype.then=function(t,n){var r,o,u,i;return u=new e,o={y:t,n:n,p:u},this.state===d?this.c?this.c.push(o):this.c=[o]:(i=this.state,r=this.v,g(function(){i===p?m(o,r):y(o,r)})),u},e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(t){return this.then(t,t)},e.prototype.timeout=function(t,n){return n=n||"timeout",new e(function(e){return function(r,o){setTimeout(function(){return o(Error(n))},t),e.then(function(t){r(t)},function(t){o(t)})}}(this))},e.prototype.callback=function(t){return"function"==typeof t&&(this.then(function(e){return t(null,e)}),this.catch(function(e){return t(e,null)})),this},e}();var w=f,x=function(t){var e;return e=new w,e.resolve(t),e},T=function(t){var e;return e=new w,e.reject(t),e},b=function(t){var e,n,r,o,u,i,s,c;for(s=[],u=0,c=new w,i=function(e,n){e&&"function"==typeof e.then||(e=x(e)),e.then(function(e){s[n]=e,u++,u===t.length&&c.resolve(s)},function(t){c.reject(t)})},e=n=0,r=t.length;n<r;e=++n)o=t[e],i(o,e);return t.length||c.resolve(s),c},k=function(t){return new w(function(e,n){return t.then(function(t){return e(new c({state:"fulfilled",value:t}))}).catch(function(t){return e(new c({state:"rejected",reason:t}))})})},E=function(t){return b(t.map(k))};w.all=b,w.reflect=k,w.reject=T,w.resolve=x,w.settle=E,w.soon=g,e.exports=w}),e.define("js-cookie/src/js.cookie",function(t,e,n,r,o){!function(n){var r=!1;if("function"==typeof define&&define.amd&&(define(n),r=!0),"object"==typeof e&&(t.exports=n(),r=!0),!r){var o=window.Cookies,u=window.Cookies=n();u.noConflict=function(){return window.Cookies=o,u}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(n){function r(e,o,u){var i;if("undefined"!=typeof document){if(arguments.length>1){if(u=t({path:"/"},r.defaults,u),"number"==typeof u.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*u.expires),u.expires=s}try{i=JSON.stringify(o),/^[\{\[]/.test(i)&&(o=i)}catch(t){}return o=n.write?n.write(o,e):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape),document.cookie=[e,"=",o,u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join("")}e||(i={});for(var c=document.cookie?document.cookie.split("; "):[],a=/(%[0-9A-Z]{2})+/g,l=0;l<c.length;l++){var f=c[l].split("="),p=f.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{var d=f[0].replace(a,decodeURIComponent);if(p=n.read?n.read(p,d):n(p,d)||p.replace(a,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(e===d){i=p;break}e||(i[d]=p)}catch(t){}}return i}}return r.set=r,r.get=function(t){return r.call(r,t)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(e,n){r(e,"",t(n,{expires:-1}))},r.withConverter=e,r}return e(function(){})})}),e.define("./blueprints/browser",function(t,n,r,o,u){var i,s,c,a,l,f,p,d,h,v,y,m;for(h=e("./utils"),h.isFunction,y=h.statusCreated,h.statusNoContent,h.statusOk,v=e("./blueprints/url"),s=v.byId,m=v.storePrefixed,c=function(t){var e;return e="/"+t,{list:{url:e,method:"GET"},get:{url:s(t),method:"GET"}}},i={account:{get:{url:"/account",method:"GET",useCustomerToken:!0},update:{url:"/account",method:"PATCH",useCustomerToken:!0},exists:{url:function(t){var e,n,r;return"/account/exists/"+(null!=(e=null!=(n=null!=(r=t.email)?r:t.username)?n:t.id)?e:t)},method:"GET",process:function(t){return t.data.exists}},create:{url:"/account/create",expects:y},enable:{url:function(t){var e;return"/account/enable/"+(null!=(e=t.tokenId)?e:t)}},login:{url:"/account/login",process:function(t){return this.setCustomerToken(t.data.token),t}},logout:function(){return this.deleteCustomerToken()},reset:{url:"/account/reset",useCustomerToken:!0},updateOrder:{url:function(t){var e,n;return"/account/order/"+(null!=(e=null!=(n=t.orderId)?n:t.id)?e:t)},method:"PATCH",useCustomerToken:!0},confirm:{url:function(t){var e;return"/account/confirm/"+(null!=(e=t.tokenId)?e:t)},useCustomerToken:!0}},cart:{create:{url:"/cart",expects:y},update:{url:function(t){var e;return"/cart/"+(null!=(e=t.id)?e:t)},method:"PATCH"},discard:{url:function(t){var e;return"/cart/"+(null!=(e=t.id)?e:t)+"/discard"}},set:{url:function(t){var e;return"/cart/"+(null!=(e=t.id)?e:t)+"/set"}}},review:{create:{url:"/review",expects:y},get:{url:function(t){var e;return"/review/"+(null!=(e=t.id)?e:t)},method:"GET"}},checkout:{authorize:{url:m("/checkout/authorize")},capture:{url:m(function(t){var e;return"/checkout/capture/"+(null!=(e=t.orderId)?e:t)})},charge:{url:m("/checkout/charge")},paypal:{url:m("/checkout/paypal")}},referrer:{create:{url:"/referrer",expects:y},get:{url:function(t){var e;return"/referrer/"+(null!=(e=t.id)?e:t)},method:"GET"}}},d=["collection","coupon","product","variant"],a=function(t){return i[t]=c(t)},l=0,f=d.length;l<f;l++)p=d[l],a(p);t.exports=i}),e.define("./blueprints/url",function(t,n,r,o,u){var i,s;i=e("./utils").isFunction,n.storePrefixed=s=function(t){return function(e){var n;return n=i(t)?t(e):t,null!=this.storeId?"/store/"+this.storeId+n:n}},n.byId=function(t){switch(t){case"coupon":return s(function(t){var e;return"/coupon/"+(null!=(e=t.code)?e:t)});case"collection":return s(function(t){var e;return"/collection/"+(null!=(e=t.slug)?e:t)});case"product":return s(function(t){var e,n;return"/product/"+(null!=(e=null!=(n=t.id)?n:t.slug)?e:t)});case"variant":return s(function(t){var e,n;return"/variant/"+(null!=(e=null!=(n=t.id)?n:t.sku)?e:t)});case"site":return function(t){var e,n;return"/site/"+(null!=(e=null!=(n=t.id)?n:t.name)?e:t)};default:return function(e){var n;return"/"+t+"/"+(null!=(n=e.id)?n:e)}}}}),e.define("./browser",function(n,r,o,u,i){var s,c;null==t.Hanzo&&(t.Hanzo={}),s=e("./api"),c=e("./client/xhr"),s.CLIENT=c,s.BLUEPRINTS=e("./blueprints/browser"),Hanzo.Api=s,Hanzo.Client=c,n.exports=Hanzo}),e("./browser")}).call(this,this);
